<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <!-- <script>
        // javascript
        // Create canvas element
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 600;
        canvas.height = 400;
        document.body.appendChild(canvas);

        // Create platform
        const platform = {
            x: 250,
            y: 375,
            width: 100,
            height: 10,
            color: '#f44242'
        };

        // Create ball
        let ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 10,
            speed: 3,
            dx: 3,
            dy: -3
        };

        // Create blocks
        let blocks = [];
        const blockWidth = 50;
        const blockHeight = 20;
        const blockRowCount = 4;
        const blockColCount = 10;
        const blockMargin = 10;
        const blockOffsetTop = 30;
        const blockOffsetLeft = 30;
        for (let i = 0; i < blockRowCount; i++) {
            for (let j = 0; j < blockColCount; j++) {
                blocks.push({
                    x: j * (blockWidth + blockMargin) + blockOffsetLeft,
                    y: i * (blockHeight + blockMargin) + blockOffsetTop,
                    width: blockWidth,
                    height: blockHeight,
                    status: true,
                    color: getRandomColor()
                });
            }
        }

        // Draw platform
        function drawPlatform() {
            ctx.beginPath();
            ctx.rect(platform.x, platform.y, platform.width, platform.height);
            ctx.fillStyle = platform.color;
            ctx.fill();
            ctx.closePath();
        }

        // Draw ball
        function drawBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = '#0095DD';
            ctx.fill();
            ctx.closePath();
        }

        // Draw blocks
        function drawBlocks() {
            blocks.forEach((block) => {
                if (block.status) {
                    ctx.beginPath();
                    ctx.rect(block.x, block.y, block.width, block.height);
                    ctx.fillStyle = block.color;
                    ctx.fill();
                    ctx.closePath();
                }
            });
        }

        // Move ball
        function moveBall() {
            // Bounce off left and right walls
            if (ball.x + ball.dx > canvas.width - ball.radius || ball.x + ball.dx < ball.radius) {
                ball.dx = -ball.dx;
            }

            // Bounce off top wall
            if (ball.y + ball.dy < ball.radius) {
                ball.dy = -ball.dy;
            } else if (ball.y + ball.dy > canvas.height - ball.radius) { // Ball hits bottom wall
                if (ball.x > platform.x && ball.x < platform.x + platform.width) { // Ball hits platform
                    ball.dy = -ball.dy;
                } else { // Game over
                    alert('Game over!');
                    document.location.reload();
                    clearInterval(interval);
                }
            }

            ball.x += ball.dx;
            ball.y += ball.dy;
        }

        // Move platform
        function movePlatform(event) {
            if (event.keyCode === 37) { // Left arrow key
                platform.x -= 20;
            } else if (event.keyCode === 39) { // Right arrow key
                platform.x += 20;
            }

            // Prevent platform from going out of bounds
            if (platform.x < 0) {
                platform.x = 0;
            }
            if (platform.x + platform.width > canvas.width) {
                platform.x = canvas.width - platform.width;
            }
        }

        // Detect collision with blocks
        function detectBlockCollision() {
            blocks.forEach((block) => {
                if (block.status) {
                    if (ball.x > block.x && ball.x < block.x + block.width && ball.y > block.y && ball.y < block.y + block.height) {
                        ball.dy = -ball.dy;
                        block.status = false;
                    }
                }
            });
        }

        // Generate random color
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        // Update canvas
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPlatform();
            drawBall();
            drawBlocks();
            moveBall();
            detectBlockCollision();
        }

        // Keyboard event listener
        document.addEventListener('keydown', movePlatform);

        // Game loop
        let interval = setInterval(update, 10);
    </script> -->

    <canvas id="game"></canvas>
    <script>
        // javascript
        // Оголошення констант та змінних
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;

        let enemies = [];
        let towers = [];
        let projectiles = [];

        // Класи
        class Enemy {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 20;
                this.height = 20;
                this.health = 100;
                this.speed = 2;
                this.color = 'green';
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }
            update() {
                this.x += this.speed;
            }
            attack() {
                player.health -= 10;
            }
        }

        class Tower {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 20;
                this.height = 20;
                this.color = 'grey';
                this.fireRate = 60;
                this.readyToFire = true;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }
            update() {
                if (this.readyToFire) {
                    projectiles.push(new Projectile(this.x + this.width / 2, this.y - this.height));
                    this.readyToFire = false;
                    setTimeout(() => {
                        this.readyToFire = true;
                    }, this.fireRate);
                }
            }
        }

        class Projectile {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 5;
                this.height = 5;
                this.speed = 5;
                this.color = 'red';
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }
            update() {
                this.y -= this.speed;
            }
            hit(enemy) {
                if (
                    this.x < enemy.x + enemy.width &&
                    this.x + this.width > enemy.x &&
                    this.y < enemy.y + enemy.height &&
                    this.y + this.height > enemy.y
                ) {
                    enemy.health -= 10;
                    return true;
                }
                return false;
            }
        }

        // Додавання ворогів
        function addEnemies() {
            setInterval(() => {
                const enemy = new Enemy(-20, Math.floor(Math.random() * (height - 20)));
                enemies.push(enemy);
            }, 2000);
        }

        // Відтворення
        function render() {
            ctx.clearRect(0, 0, width, height);

            // Відображення ворогів
            enemies.forEach(enemy => {
                if (enemy.health <= 0) {
                    const index = enemies.findIndex(e => e === enemy);
                    enemies.splice(index, 1);
                    return;
                }
                if (enemy.x > width) {
                    const index = enemies.findIndex(e => e === enemy);
                    enemies.splice(index, 1);
                    player.health -= 20;
                    return;
                }
                enemy.draw();
                enemy.update();
            });

            // Відображення веж
            towers.forEach(tower => {
                tower.draw();
                tower.update();
            });

            // Відображення снарядів
            projectiles.forEach(projectile => {
                projectile.draw();
                projectile.update();
                enemies.forEach(enemy => {
                    if (projectile.hit(enemy)) {
                        const index = projectiles.findIndex(p => p === projectile);
                        projectiles.splice(index, 1);
                    }
                });
            });

            // Оновлення результату гравця
            score.innerHTML = `Score: ${player.score}`;
            health.innerHTML = `Health: ${player.health}`;

            if (player.health <= 0) {
                clearInterval(gameInterval);
                alert('Game Over!');
            }

            requestAnimationFrame(render);
        }

        // Додавання Веж
        canvas.addEventListener('click', e => {
            const tower = new Tower(e.offsetX, e.offsetY);
            towers.push(tower);
        });

        // Запуск гри
        const player = {
            health: 100,
            score: 0
        };
        const score = document.getElementById('score');
        const health = document.getElementById('health');
        render();
        addEnemies();
        const gameInterval = setInterval(() => {
            player.score += 1;
        }, 1000);
    </script>
</body>

</html>